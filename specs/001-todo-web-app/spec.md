# 功能規格: Todo 待辦事項 Web 應用程式

**Feature Branch**: `001-todo-web-app`
**Created**: 2025-11-23
**Status**: Draft
**Input**: User description: "建立一個Todo Web App,可以提供新增、修改、刪除待辦事項及標示待辦事項為完成/未完成,系統畫面上與現行的主流的網站設計風格對齊,操作方式及動線簡單容易操作"

## Clarifications

### Session 2025-11-23

- Q: 成功操作提示訊息的顯示方式與位置 → A: Toast 通知顯示在畫面右上角(浮動訊息),3 秒後自動消失
- Q: 待辦事項在清單中的預設排序方式 → A: 未完成的在上方,已完成的在下方(依完成狀態分組,組內再依時間排序)
- Q: 資料儲存失敗時的錯誤處理策略 → A: 顯示警告訊息,允許繼續操作但資料僅在會話期間有效(重新整理後遺失)
- Q: 已完成與未完成待辦事項的視覺區隔方式 → A: 使用分隔線加上組別標題(如「進行中」「已完成」)
- Q: 當使用者輸入包含 HTML 標籤或 JavaScript 程式碼的待辦事項時,系統應該如何處理? → A: 顯示時轉義 - 原樣儲存使用者輸入,顯示時轉換為 HTML 實體以防止 XSS 攻擊
- Q: 響應式設計應該使用哪些螢幕寬度中斷點來區分手機、平板、桌面裝置? → A: 手機 <768px，平板 768-1024px，桌面 >1024px（業界標準中斷點）
- Q: 當使用者嘗試新增空白待辦事項時,應該顯示什麼錯誤訊息? → A: 「請輸入待辦事項內容」
- Q: 當本地儲存失敗時顯示的警告橫幅應該如何呈現? → A: 黃色背景橫幅固定在頁面頂部，有 X 關閉按鈕可暫時關閉，但重新載入頁面時會再次顯示以持續提醒使用者
- Q: 當清單中僅有「未完成」或僅有「已完成」待辦事項時,應該如何顯示組別標題和分隔線? → A: 僅顯示有項目的組別，空組別不顯示標題和分隔線（避免視覺雜訊）

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 新增與檢視待辦事項 (Priority: P1)

使用者可以建立新的待辦事項並在清單中立即看到。使用者開啟應用程式時,能看到所有待辦事項的清單,並能快速新增新的待辦事項。

**Why this priority**: 這是 Todo 應用的核心功能,沒有新增與檢視功能就無法使用應用程式。這是 MVP 的最基本需求。

**Independent Test**: 可以透過開啟應用程式、輸入待辦事項文字、點擊新增按鈕,然後確認該事項出現在清單中來獨立測試此功能。

**Acceptance Scenarios**:

1. **Given** 使用者開啟應用程式, **When** 畫面載入完成, **Then** 顯示所有現有的待辦事項清單,依完成狀態分組並以組別標題(「進行中」「已完成」)和分隔線區隔(如果沒有事項則顯示空白清單狀態)
2. **Given** 使用者在待辦事項清單頁面, **When** 使用者在輸入框輸入文字並點擊「新增」按鈕, **Then** 新的待辦事項立即出現在清單中,輸入框清空
3. **Given** 使用者在待辦事項清單頁面, **When** 使用者點擊「新增」按鈕但輸入框為空, **Then** 顯示錯誤提示訊息「請輸入待辦事項內容」
4. **Given** 使用者新增了一個待辦事項, **When** 使用者重新整理頁面, **Then** 新增的待辦事項仍然存在於清單中

---

### User Story 2 - 標示完成狀態 (Priority: P2)

使用者可以將待辦事項標記為已完成或未完成,並能快速識別哪些事項已完成。使用者透過點擊核取方塊來切換完成狀態。

**Why this priority**: 標記完成是 Todo 應用的第二重要功能,讓使用者能追蹤進度。有了 P1 的新增功能後,此功能可以獨立開發與測試。

**Independent Test**: 可以透過點擊待辦事項旁的核取方塊,觀察視覺變化(如刪除線),再次點擊恢復原狀來獨立測試。

**Acceptance Scenarios**:

1. **Given** 清單中有未完成的待辦事項, **When** 使用者點擊該事項的核取方塊, **Then** 該事項標記為已完成,顯示視覺回饋(如刪除線、變更顏色),並移動到已完成組別(清單下方)
2. **Given** 清單中有已完成的待辦事項, **When** 使用者點擊該事項的核取方塊, **Then** 該事項標記為未完成,移除完成狀態的視覺樣式,並移動到未完成組別(清單上方)
3. **Given** 使用者標記了事項的完成狀態, **When** 使用者重新整理頁面, **Then** 事項的完成狀態與排序位置保持不變
4. **Given** 清單中有多個待辦事項, **When** 使用者切換其中一個事項的完成狀態, **Then** 只有該事項的狀態改變,其他事項不受影響

---

### User Story 3 - 編輯待辦事項 (Priority: P3)

使用者可以修改已建立的待辦事項內容,以更正錯誤或更新資訊。使用者點擊待辦事項可進入編輯模式,修改完成後儲存變更。

**Why this priority**: 編輯功能提升使用者體驗,但即使沒有此功能,使用者也可以刪除並重新建立事項作為替代方案。

**Independent Test**: 可以透過點擊待辦事項文字進入編輯模式、修改內容、儲存,然後確認文字已更新來獨立測試。

**Acceptance Scenarios**:

1. **Given** 清單中有待辦事項, **When** 使用者點擊該事項的文字, **Then** 該事項進入編輯模式,顯示可編輯的輸入框並預先填入原有文字
2. **Given** 待辦事項處於編輯模式, **When** 使用者修改文字並按下儲存(或 Enter 鍵), **Then** 事項以新文字更新並退出編輯模式
3. **Given** 待辦事項處於編輯模式, **When** 使用者按下取消(或 ESC 鍵), **Then** 事項保持原有文字並退出編輯模式
4. **Given** 待辦事項處於編輯模式, **When** 使用者清空文字並嘗試儲存, **Then** 顯示錯誤提示訊息「請輸入待辦事項內容」,不允許儲存空白內容

---

### User Story 4 - 刪除待辦事項 (Priority: P4)

使用者可以從清單中永久移除不需要的待辦事項。每個待辦事項旁有刪除按鈕,點擊後會要求確認再執行刪除。

**Why this priority**: 刪除功能是清理清單的必要功能,但使用者可以先透過標記完成來管理不需要的事項,因此優先級較低。

**Independent Test**: 可以透過點擊待辦事項的刪除按鈕、確認刪除對話框,然後驗證該事項從清單中消失來獨立測試。

**Acceptance Scenarios**:

1. **Given** 清單中有待辦事項, **When** 使用者點擊該事項的刪除按鈕, **Then** 顯示確認對話框,詢問「確定要刪除此待辦事項嗎?」
2. **Given** 刪除確認對話框顯示中, **When** 使用者點擊「確認」, **Then** 該待辦事項從清單中移除,顯示刪除成功的提示訊息
3. **Given** 刪除確認對話框顯示中, **When** 使用者點擊「取消」, **Then** 對話框關閉,待辦事項保留在清單中
4. **Given** 使用者刪除了待辦事項, **When** 使用者重新整理頁面, **Then** 該事項不再出現在清單中

---

### Edge Cases

- 當使用者嘗試新增超長文字(超過 500 字元,即 >500)時,系統應該限制輸入長度或顯示警告訊息
- 當使用者嘗試新增包含特殊字元(如 HTML 標籤、JavaScript 程式碼)的待辦事項時,系統應該原樣儲存輸入,但在顯示時將特殊字元轉換為 HTML 實體以防止 XSS 攻擊(如 `<script>` 顯示為文字而非執行)
- 當清單中沒有任何待辦事項時,應顯示友善的空白狀態訊息(如「目前沒有待辦事項,點擊上方新增您的第一個任務!」)
- 當網路連線中斷時,系統應顯示離線狀態提示,並在可能的情況下允許繼續操作(資料暫存於本地)
- 當本地儲存失敗時(如瀏覽器儲存空間已滿、隱私模式限制、儲存權限被拒絕),系統應在頁面頂部顯示黃色背景的警告橫幅(包含 X 關閉按鈕),通知使用者資料無法持久化,橫幅可暫時關閉但每次重新載入時再次顯示,仍允許繼續操作(資料僅在當前會話有效,重新整理後會遺失)
- 當有大量待辦事項(如超過 100 個)時,系統應保持良好效能,頁面載入與操作不應明顯延遲
- 當多個使用者同時編輯同一個待辦事項時,系統應該正確處理衝突(本階段假設單一使用者使用,未來可考慮多使用者支援)

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統必須允許使用者新增待辦事項,每個事項包含文字描述
- **FR-002**: 系統必須顯示所有待辦事項的清單,依完成狀態分組顯示(未完成的在上方,已完成的在下方)。當兩個組別都有項目時,使用分隔線和組別標題(如「進行中」「已完成」)明確區隔；當僅有一個組別有項目時,僅顯示該組別(空組別不顯示標題和分隔線)。同一組內按新增時間倒序排列(最新的在最上方)
- **FR-003**: 系統必須允許使用者將待辦事項標記為已完成或未完成
- **FR-004**: 系統必須允許使用者編輯現有待辦事項的文字內容
- **FR-005**: 系統必須允許使用者刪除待辦事項,並在刪除前顯示確認對話框
- **FR-006**: 系統必須在使用者輸入空白待辦事項時顯示錯誤訊息「請輸入待辦事項內容」
- **FR-007**: 系統必須限制待辦事項文字長度上限為 500 字元
- **FR-008**: 系統必須持久化儲存所有待辦事項資料,確保重新載入頁面後資料不遺失。若本地儲存失敗(如儲存空間已滿、隱私模式限制),系統必須在頁面頂部顯示黃色背景的警告橫幅(包含關閉按鈕),通知使用者「無法儲存資料,重新整理後將遺失所有變更」,橫幅可暫時關閉但每次重新載入時再次顯示,並允許繼續操作(資料僅在當前會話期間有效)
- **FR-009**: 系統必須在每次操作成功後於畫面右上角顯示 Toast 通知訊息,訊息應在 3 秒後自動消失,無需使用者手動關閉
- **FR-010**: 系統必須防止 XSS 攻擊,原樣儲存使用者輸入的所有字元(包含 HTML 標籤、JavaScript 程式碼),在顯示時將特殊字元轉換為 HTML 實體(如 `<` 轉為 `&lt;`)
- **FR-011**: 系統必須在清單為空時顯示友善的空白狀態引導訊息
- **FR-012**: 系統必須在操作進行中顯示載入指示器(如儲存待辦事項時)

### Key Entities

- **待辦事項 (Todo Item)**: 代表使用者要完成的任務,包含以下屬性:
  - 唯一識別碼(用於編輯與刪除操作)
  - 文字描述(最多 500 字元)
  - 完成狀態(已完成/未完成)
  - 建立時間(用於排序)
  - 最後更新時間(可選,用於追蹤修改歷史)

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者可以在 3 秒內完成新增一個待辦事項(從開始輸入到出現在清單中)
- **SC-002**: 使用者可以在 1 秒內切換待辦事項的完成狀態並看到視覺回饋
- **SC-003**: 系統在載入 100 個待辦事項時,頁面完整載入時間不超過 2 秒
- **SC-004**: 90% 的使用者能在首次使用時,無需說明文件即可成功完成新增、標記完成、編輯、刪除四項基本操作
- **SC-005**: 所有操作(新增、編輯、刪除、標記完成)的成功率達到 99.9%(排除網路故障等外部因素)
- **SC-006**: 使用者介面在主流瀏覽器(Chrome, Firefox, Safari, Edge 最新版本)上顯示一致且功能完整
- **SC-007**: 應用程式在手機(<768px)、平板(768-1024px)、桌面(>1024px)裝置上都能正常使用且操作流暢,介面自動適應不同螢幕尺寸(響應式設計)
- **SC-008**: 使用者在執行任何操作後,都能在 100 毫秒內看到初步的視覺回饋(如按鈕點擊效果、載入指示器)
- **SC-009**: 系統在載入 500-1000 個待辦事項時仍保持流暢操作,滾動與互動回應時間不超過 100 毫秒,頁面載入時間不超過 3 秒

## Assumptions *(optional)*

以下是基於常見 Todo 應用實踐的合理假設:

1. **單一使用者模式**: 目前階段假設應用程式為單一使用者使用,資料儲存於使用者的瀏覽器本地,不涉及多使用者帳號系統或資料同步
2. **資料儲存**: 採用瀏覽器本地儲存機制(如 localStorage 或 IndexedDB),不需要後端伺服器或資料庫
3. **無分類功能**: 初期版本不包含待辦事項分類、標籤、優先級等進階功能,專注於核心 CRUD 操作
4. **無到期日**: 待辦事項不包含到期日期或提醒功能
5. **無搜尋與篩選**: 初期版本不包含搜尋或篩選功能(如只顯示未完成事項)
6. **現代瀏覽器支援**: 目標瀏覽器為最新版本的主流瀏覽器,不需支援 IE11 等舊版瀏覽器
7. **網路連線**: 假設使用者有穩定的網路連線來載入應用程式資源,但應用程式載入後可離線運作
8. **無資料匯出/匯入**: 初期版本不包含資料匯出或匯入功能
9. **介面語言**: 預設使用正體中文介面,暫不支援多語言切換

## Design Principles *(optional)*

為確保「與主流網站設計風格對齊,操作簡單容易」,本應用遵循以下設計原則:

1. **簡潔優先**: 介面元素保持最少,避免視覺雜訊,讓使用者專注於任務本身
2. **即時回饋**: 所有操作都提供即時的視覺或動畫回饋,讓使用者清楚知道操作結果
3. **容錯設計**: 提供取消、復原機制(如編輯取消、刪除確認),降低誤操作的影響
4. **視覺層級**: 使用大小、顏色、間距建立清楚的視覺層級,突出主要操作(如新增按鈕)
5. **一致性**: 操作模式、視覺元件、互動行為在整個應用程式中保持一致
6. **無障礙性**: 確保鍵盤操作支援(如 Enter 儲存、ESC 取消)與適當的 ARIA 標籤
7. **響應式設計**: 自動適應不同螢幕尺寸,在手機、平板、桌面都提供良好體驗
